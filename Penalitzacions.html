#Criteris de qualitat d'exercicis de SQL i exemples de solucions que no els compleixen

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0105)https://learnsql.fib.upc.es/moodle/file.php/3/1_Material_classes_Algebra_i_SQL/ExemplesPenalitzables.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><title>Penalitzacions</title></head><body>
<p style="margin-bottom: 6pt;" class="MsoNormal"><b><span style="font-size: 14pt;" lang="CA">Correcci� posterior als lliuraments en el LearnSQL (nom�s solucions que passen el joc de proves p�blic com a m�nim)</span></b></p>

<ul>
<li><span style="font-family: wingdings;" lang="CA"><span><span></span></span></span><span lang="CA">El
 corrector t�, en principi, suficients jocs de prova per garantir que la
 soluci� d�un estudiant d�un exercici �s o no correcte. Ara b�, si 
durant la correcci� posterior es troba algun <span style="font-weight: bold;">error que no ha estat detectat per cap joc de prova</span>, el professor pot aplicar una penalitzaci� <span style="font-weight: bold;"></span>segons la gravetat de l�error.</span></li><ul><li><span lang="CA">Penalitzaci� en general ser� de <span style="font-weight: bold;">2 punts</span>, per� pot arribar ser de la <span style="font-weight: bold;">totalitat del valor de la pregunta</span> segons la gravetat de l'error.</span></li></ul>
</ul>

<p style="margin-bottom: 6pt;" class="MsoNormal"><span lang="CA"> </span></p>

<ul>
<li><span lang="CA">El corrector no t� possibilitat de veure si un 
exercici correcte compleix o no els criteris de qualitat que s�indiquen 
m�s endavant. En la correcci� posterior, el professor repassar� que la 
soluci� compleixi els criteris de qualitat indicats per cada tipus 
d�exercici. Si una soluci� no compleix algun dels criteris s�aplicar� 
una penalitzaci�. </span></li>
</ul>


<p style="margin-bottom: 6pt;" class="MsoNormal"><span lang="CA"> </span></p>



<p style="margin-bottom: 6pt; margin-left: 40px; font-weight: bold;" class="MsoNormal"><big><big><big><span style="font-size: 14pt;" lang="CA">Criteris de qualitat per a les sent�ncies SQL a l�assignatura BD</span></big></big></big></p>

<ul style="margin-left: 40px;">
<li><span style="font-family: wingdings;" lang="CA"><span><span></span></span></span><span lang="CA">S�usa �nicament les cl�usules de SQL explicades a les transpar�ncies, i de la manera presentada a les transpar�ncies. </span></li><ul><li><span lang="CA">Penalitaci� m�xima de<span style="font-weight: bold;"> 7 punts.</span></span></li></ul>
</ul>
<span lang="CA"><span style="font-weight: bold;"></span></span>
<ul style="margin-left: 40px;">
<li><span style="font-family: wingdings;" lang="CA"><span></span></span><span lang="CA"><span style="font-weight: bold;"></span> </span><span lang="CA">S�usa la cl�usula DISTINCT en el cas que una consulta 
pugui donar (per algun contingut de la base de dades) resultats amb 
repeticions, i no s�usa en el cas que una consulta no en pugui donar. 
Aquest criteri nom�s �s rellevant pel que fa a les consultes, per� no a 
les subconsultes dins d�una consulta.</span></li><ul><li><span lang="CA">Penalitzaci� m�xima de <span style="font-weight: bold;">2 punts</span>.</span></li></ul>
</ul>

<ul style="margin-left: 40px;">
<li><span lang="CA">La sent�ncia SQL no t� parts redundants. Exemples de 
consultes amb parts innecess�ries o redundats: S�usa taules que no s�n 
necess�ries per a obtenir el resultat de la consulta; S�usa group by en 
una consulta que d�na, sigui quin sigui el contingut de la base de 
dades, un �nic grup; ...</span></li><ul><li><span lang="CA">Penalitzaci� m�xima de <span style="font-weight: bold;">1 punts</span> per cada utilitzaci� d'una part redundant. <br></span></li><li><span lang="CA"></span><span lang="CA">Exemples:</span></li></ul>
</ul>
 <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span>

  
    

    
    
  
<table style="border-style: solid; border-color: rgb(0, 0, 0); width: 85%; background-image: none; float: none; text-align: left; vertical-align: top; background-color: rgb(255, 255, 255); margin-left: auto; margin-right: auto;" border="2" cellpadding="3" cellspacing="1" frame="box" rules="all">
 <tbody><tr><td style="border-style: none; text-align: left; background-image: none; vertical-align: top; background-color: white;" valign="top">
      <div style="margin-left: 120px;"><br></div>
    </td><td style="border-style: none; text-align: left; background-image: none; vertical-align: top; width: 500px; background-color: white;" valign="top" width="33%">No compleix el criteri<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%">Compleix el criteri<br>
    </td></tr><tr><td style="text-align: left; background-color: white;" valign="top">Taula no necess�ria per obtenir el resultat d'una consulta.<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT e.num_empl, e.nom_empl<br>
FROM empleats e, departaments d<br>
WHERE e.num_dpt = d.num_dpt <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND d.num_dpt = 20</small><br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT e.num_empl, e.nom_empl<br>
FROM empleats e<br>
WHERE e.num_dpt = 20</small>
    </td></tr><tr><td style="text-align: left; background-color: white;" valign="top">�s de Group By en una consulta que d�na, independentment del contingut de la base de dades, un �nic grup.<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT e.num_empl, e.nom_empl<br>
FROM empleats e<br>
WHERE e.sou &gt; (SELECT AVG(e1.sou)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM empleats e1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE e1.num_dpt = 5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY e1.num_dpt)</small><br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT e.num_empl, e.nom_empl<br>
FROM empleats e<br>
WHERE e.sou &gt; (SELECT AVG(e1.sou)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM empleats e1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE e1.num_dpt = 5)</small>
    </td></tr><tr><td style="vertical-align: top; background-color: white;">Posar com a condici� en un GROUP BY qu� el grup t� com a m�nim una fila<br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT e.num_dpt, MAX(e.sou)<br>
 FROM empleats e<br>
 GROUP BY e.num_dpt<br>
 HAVING count(*) &gt; 0</small><br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT e.num_dpt, MAX(e.sou)<br>
 FROM empleats e<br>
 GROUP BY e.num_dpt</small><br>
    </td></tr><tr><td style="vertical-align: top; background-color: white;">Posar un atribut innecessari en els atributs d'un GROUP BY<br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT d.num_dpt, d.nom_dpt<br>
 FROM empleats e, departaments d<br>
 WHERE e.num_dpt = d.num_dpt<br>
 GROUP BY d.num_dpt, d.nom_dpt,&nbsp; d.ciutat_dpt<br>
 HAVING AVG(e.sou) &gt; 2000</small><br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT d.num_dpt, d.nom_dpt<br>
 FROM empleats e, departaments d<br>
 WHERE e.num_dpt = d.num_dpt<br>
 GROUP BY d.num_dpt, d.nom_dpt<br>
 HAVING AVG(e.sou) &gt; 2000</small>
    </td></tr> </tbody>
</table>

<ul style="margin-left: 40px;">
<li><span lang="CA">S'usa subconsultes que clarament es poden evitar. </span></li><ul><li><span lang="CA">Penalitzaci� m�xima de <span style="font-weight: bold;">2 punts</span> per cada subconsulta clarament evitable<span style="font-weight: bold;">.</span></span></li><li><span lang="CA">Exemples de subconsultes que es penalitzaran:</span></li></ul>
</ul>
 <span lang="CA"></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span>

  
    
    

    
  
<table style="border-style: solid; border-color: rgb(0, 0, 0); width: 85%; background-image: none; float: none; text-align: left; vertical-align: top; background-color: rgb(255, 255, 255); margin-left: auto; margin-right: auto;" border="2" cellpadding="3" cellspacing="1" frame="box" rules="all">
 <tbody><tr><td style="border-style: none; text-align: left; width: 200px; background-image: none; vertical-align: top; background-color: white;">
      <div style="margin-left: 120px;"><br></div>
    </td><td style="border-style: none; text-align: left; background-image: none; vertical-align: top; width: 500px; background-color: white;" valign="top" width="33%">No compleix el criteri<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%">Compleix el criteri<br>
    </td></tr><tr><td style="text-align: left; background-color: white;" valign="top" width="33%">Subconsulta amb IN innecessari en lloc d'usar una combinaci�/join de taules..<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT d.num_dpt, d.nom_dpt<br>
FROM departaments d<br>
WHERE d.num_dpt IN (SELECT e.num_dpt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM empleats e<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE e.ciutat_dpt = 'VIC') </small><br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT distinct d.num_dpt, d.nom_dpt<br>
FROM departaments d, empleats e<br>
WHERE d.num_dpt = e.num_dpt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND e.ciutat_empl = 'VIC'</small><br>
    </td></tr><tr><td style="text-align: left; background-color: white;" valign="top" width="33%">Subconsulta amb EXISTS innecessari en lloc d'usar una combinaci�/join de taules.<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT d.num_dpt, d.nom_dpt<br>
 FROM departaments d<br>
 WHERE EXISTS (SELECT *<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM empleats e<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE e.num_dpt = d.num_dpt <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
AND e.ciutat_dpt = 'VIC')</small>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>SELECT distinct d.num_dpt, d.nom_dpt<br>
 FROM departaments d, empleats e<br>
 WHERE d.num_dpt = e.num_dpt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
AND e.ciutat_empl = 'VIC'</small>
    </td></tr><tr><td style="vertical-align: top; background-color: white;">Subconsulta per comptar, en lloc d'usar una combinaci�/join de taules<br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT d.num_dpt, d.nom_dpt<br>
 FROM departaments d<br>
 WHERE 0 &lt; (SELECT count(*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM empleats e<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE e.num_dpt = d.num_dpt <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
AND e.ciutat_dpt = 'VIC')</small>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT distinct d.num_dpt, d.nom_dpt<br>
 FROM departaments d, empleats e<br>
 WHERE d.num_dpt = e.num_dpt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
AND e.ciutat_empl = 'VIC'</small>
    </td></tr><tr><td style="vertical-align: top; background-color: white;">Subconsulta en lloc d'usar group by-having<br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT d.num_dpt, d.nom_dpt<br>
 FROM departaments d<br>
 WHERE 2 &lt; (SELECT count(*) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM empleats <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
WHERE d.num_dpt = e.num_dpt)</small><br>
    </td><td style="vertical-align: top; background-color: white;"><small>SELECT d.num_dpt, d.nom_dpt<br>
 FROM departaments d, empleats e<br>
 WHERE d.num_dpt = e.num_dpt<br>
 GROUP BY d.num_dpt, d.nom_dpt<br>
 HAVING count(*) &gt; 2</small>
    </td></tr> </tbody>
</table>
 <br>
<p style="margin-bottom: 6pt; margin-left: 40px; font-weight: bold;" class="MsoNormal"><big><big><span style="font-size: 14pt;" lang="CA">Criteris de qualitat per a les seq��ncies d'operacions en �lgebra relacional a l�assignatura BD</span></big></big></p>

<ul style="margin-left: 40px;">
<li><span style="font-family: wingdings;" lang="CA"><span><span></span></span></span><span lang="CA"></span><span lang="CA"></span> <span lang="CA">La
 seq��ncia d'operacions no inclou operacions o taules redundants. 
Exemples: S�usa taules que no s�n necess�ries per a obtenir el resultat 
de la consulta; Es fa combinacions (joins) no necess�ries; ...<br> </span></li><ul><li><span lang="CA">Penalitzaci� m�xima de <span style="font-weight: bold;">1 punts</span> per cada operaci� o taula redundant. <br></span></li><li><span lang="CA"></span><span lang="CA">Exemples:</span></li></ul>
</ul>
 <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span> <span lang="CA"><span style="font-weight: bold;"></span></span>

  
<table style="border-style: solid; border-color: rgb(0, 0, 0); width: 80%; background-image: none; float: none; text-align: left; vertical-align: top; background-color: rgb(255, 255, 255); margin-left: auto; margin-right: auto;" border="2" cellpadding="3" cellspacing="1" frame="box" rules="all">
 <tbody><tr><td style="border-style: none; text-align: left; background-image: none; vertical-align: top; background-color: white;" valign="top">
      <div style="margin-left: 120px;"><br></div>
    </td><td style="border-style: none; text-align: left; background-image: none; vertical-align: top; width: 500px; background-color: white;" valign="top" width="33%">No compleix el criteri<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%">Compleix el criteri<br>
    </td></tr><tr><td style="text-align: left; background-color: white;" valign="top">Taula/combinaci� no necess�ria per obtenir el resultat d'una consulta.<br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>A = empleats*departaments<br>
 B = A(num_dpt=20)<br>
 R = B[num_empl, nom_empl]</small><br>
    </td><td style="text-align: left; background-color: white;" valign="top" width="33%"><small>A = empleats(num_dpt=20)<br>
 R = A[num_empl, nom_empl]</small>
    </td></tr> </tbody>
</table>
 <span lang="CA"></span>
<br>
<br>
</body></html>
